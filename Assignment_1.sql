DROP TABLE EMP;
DROP TABLE DESIGNATION;
DROP TABLE DEPARTMENT;

--CREATE TABLE
CREATE TABLE EMP(
    EMP_CODE char(5),
    EMP_NAME char(20) NULL,
    DEPT_CODE char(5) NULL,
    DESIG_CODE char(5) NULL,
    SEX char(1) NULL,
    ADDRESS char (25) NULL,
    CITY char (20) NULL,
    STATE char (20) NULL,
    PIN char (6) NULL,
    BASIC INT NULL,
    JN_DT Date NULL,
    CONSTRAINT emp_pk PRIMARY KEY(EMP_CODE)
);
CREATE TABLE DESIGNATION(
    DESIG_CODE char(5),
    DESIG_DESC char(20) NULL,
    CONSTRAINT desigcode_pk PRIMARY KEY(DESIG_CODE)
);
CREATE TABLE DEPARTMENT(
    DEPT_CODE char(5),
    DEPT_NAME char(15) NULL,
    CONSTRAINT depcode_pk PRIMARY KEY(DEPT_CODE)
);

DESC EMP;
DESC DESIGNATION;
DESC DEPARTMENT;

--INSERT INTO TABLE
INSERT INTO DESIGNATION VALUES('MANG','Manager');
INSERT INTO DESIGNATION VALUES('EXE','Executive');
INSERT INTO DESIGNATION VALUES('OFF','Officer');
INSERT INTO DESIGNATION VALUES('CLE','Clerk');
INSERT INTO DESIGNATION VALUES('HELP','Helper');
COMMIT;

INSERT INTO DEPARTMENT VALUES('1001','Personel');
INSERT INTO DEPARTMENT VALUES('1002','Production');
INSERT INTO DEPARTMENT VALUES('1003','Purchase');
INSERT INTO DEPARTMENT VALUES('1004','Finance');
INSERT INTO DEPARTMENT VALUES('1005','Research');
COMMIT;

INSERT INTO EMP VALUES('E01','Abhiraj Sen','1002','MANG','M','Karunamoyee Housing','Kolkata','West Bengal','700091','1000000','24-07-2023');
INSERT INTO EMP VALUES('E02','Rajdeep Sen','1002','MANG','M','Karunamoyee Housing','Kolkata','West Bengal','700091','10000000','26-03-2021');
INSERT INTO EMP VALUES('E03','Toby Kar','1005','EXE','F','Karunamoyee Housing','Kolkata','West Bengal','700091','1000000000','22-07-2023');
COMMIT;

--Insert without DEPT_CODE and BASIC
INSERT INTO EMP(EMP_CODE, EMP_NAME, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT)
    VALUES('E04','AMIT SEN','CLE','M','JALPAIGURI','NJP','WEST BENGAL','700012','10000','18-01-2002');
INSERT INTO EMP(EMP_CODE, EMP_NAME, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, JN_DT)
    VALUES('E05','CHAYA KAR','OFF','F','BAGUIHATI','KOLKATA','WEST BENGAL','700002','01-01-2012');
INSERT INTO EMP(EMP_CODE, EMP_NAME, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, BASIC, JN_DT)
    VALUES('E06','ARINJOY KAR','EXE','M','NEWTOWN','KOLKATA','WEST BENGAL','700032','10000000','11-01-2025');
INSERT INTO EMP(EMP_CODE, EMP_NAME, DESIG_CODE, SEX, ADDRESS, CITY, STATE, PIN, JN_DT)
    VALUES('E07','SANJOY KAR','OFF','M','NEWTOWN','KOLKATA','WEST BENGAL','700032','17-01-2011');
COMMIT;

--DEPT CODE UNASSIGNED
SELECT * FROM EMP WHERE DEPT_CODE IS NULL;

--BASIC IS ZERO
SELECT * FROM EMP WHERE BASIC=0;

--BASIC UNASSIGNED
SELECT * FROM EMP WHERE BASIC IS NULL;

--AVERAGE BASIC OF EMPLOYEES
SELECT AVG(BASIC) FROM EMP;

--REPLACE NULL BASIC VALUES WITH 0
UPDATE EMP SET BASIC=0 WHERE BASIC IS NULL;
COMMIT;

--NEW AVERAGE
SELECT AVG(BASIC) FROM EMP;
--NOTE DIFFERENCE. IN FIRST NULL VALUES ARE NOT CONSIDERED FOR AVG. SO THE AVG IS DIFFERENT.

--DELETE ROWS WITH UNASSIGNED DEPT_CODE
DELETE FROM EMP WHERE DEPT_CODE IS NULL;
COMMIT;

--SELECT NET PAY OF EMPLOYEE
SELECT EMP_NAME, (BASIC+BASIC*0.5+BASIC*0.4) AS NET_PAY FROM EMP;

--ASCENDING ORDER OF DEPT_CODE AND CAPS NAME
--ORDER BY IS BY DEFAULT ASC.
SELECT UPPER(EMP_NAME), BASIC FROM EMP ORDER BY BASIC;
--SINCE COINCIDENTRALLY THE INPUT WAS TAKEN IN ASCENDING ORDER, I AM JUST TESTING THE DESCENDING ORDER
SELECT UPPER(EMP_NAME), BASIC FROM EMP ORDER BY BASIC DESC;

--FILLING UP THE TABLE MORE FOR BETTER UNDERSTANDING
INSERT INTO EMP VALUES('E04','Amit Sen','1001','CLE','M','Jalpaiguri','NJP','West Bengal','700012','10000','18-01-1985');
INSERT INTO EMP VALUES('E05','Chaya Kar','1002','OFF','F','Baguihati','Kolkata','West Bengal','700002','1000000','01-01-1989');
INSERT INTO EMP VALUES('E06','Arinjoy Kar','1003','EXE','M','Newtown','Kolkata','West Bengal','700032','10000000','11-01-2025');
INSERT INTO EMP VALUES('E07','Sanjoy Kar','1005','OFF','M','Newtown','Kolkata','West Bengal','700032','100000','17-01-2011');
INSERT INTO EMP VALUES('E08','Imon Ghosh','1005','EXE','M','Koramangla','Bangalore','Karnataka','900012','10000000000','18-03-2023');
INSERT INTO EMP VALUES('E09','Koninika Neogi','1001','OFF','F','Ruby','Kolkata','West Bengal','700045','10000000','02-04-2012');
INSERT INTO EMP VALUES('E10','Saloni Baid','1002','EXE','F','Baramati','Pune','Maharashtra','500032','1000000000','11-01-2025');
COMMIT;

--EMPLOYEES JOINED AFTER 1ST JANUARY 1990
SELECT * FROM EMP WHERE JN_DT > '01-01-1990';

--COUNT EMPLOYEES JOINED IN JANUARY
SELECT COUNT(*) FROM EMP WHERE EXTRACT(MONTH FROM JN_DT)=1;

--MAXIMUM AND MINIMUM BASIC
SELECT MAX(BASIC) AS MAX_BASIC, MIN(BASIC) AS MIN_BASIC FROM EMP;

--FIND NUMBER OF FEMALE EMPLOYEES
SELECT COUNT(*) AS NUMBER_OF_FEMALE_EMP FROM EMP WHERE SEX='F';

--REPLACE CITY WITH UPPER CASE CITY

UPDATE EMP SET CITY=UPPER(CITY);
COMMIT;

--COUNT NUMBER OF DIFFERENT CITY
SELECT COUNT(DISTINCT CITY) AS RESIDENT_CITIES_COUNT FROM EMP;

--MULTIPLE CONDITION SORTING SOMETHING!
SELECT * FROM EMP ORDER BY DEPT_CODE, BASIC DESC;
